webpackJsonp([2],{"5zde":function(t,e,a){a("zQR9"),a("qyJz"),t.exports=a("FeBl").Array.from},Gu7T:function(t,e,a){"use strict";e.__esModule=!0;var i,s=a("c/Tr"),n=(i=s)&&i.__esModule?i:{default:i};e.default=function(t){if(Array.isArray(t)){for(var e=0,a=Array(t.length);e<t.length;e++)a[e]=t[e];return a}return(0,n.default)(t)}},LM1A:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=a("gRE1"),s=a.n(i),n=a("bOdI"),r=a.n(n),o=a("Gu7T"),l=a.n(o),u=a("mEgX"),c=r()({name:"mapAalasis",data:function(){return{resultData:[],fluidList:[],choosedFuildList:[],getFuildLoading:!0,searchFilters:{timeParam:[new Date((new Date).getFullYear(),(new Date).getMonth(),1),new Date],companyName:"龙口胜通能源有限公司",fluid:""},map:"",markerList:"",allMakers:"",cluster:"",echartsData:{data:[],selectedData:[],legendData:[]},circleList:[],textMarkerList:[],fluidMarkerList:[],totalSalsum:0,totalCount:0,pageLoading:!1,fluidBillData:""}},mounted:function(){},methods:{getOpt:function(){return{title:{text:"贸易商销售总额占比图",subtext:"总销售额："+this.totalSalsum+"元，总销售单数"+this.totalCount+"单",subtextStyle:{color:"#333",fontSize:"14"},x:"center"},tooltip:{trigger:"item",formatter:"{a} <br/>{b} : {c} ({d}%)"},toolbox:{show:!0,right:"20%",feature:{dataView:{readOnly:!1},saveAsImage:{}}},legend:{type:"scroll",orient:"vertical",right:50,top:10,bottom:20,data:this.echartsData.legendData,selected:this.echartsData.selectedData},series:[{name:"销售总额",type:"pie",radius:["40%","65%"],center:["40%","50%"],data:this.echartsData.salsumData,legendHoverLink:!0,itemStyle:{emphasis:{shadowBlur:10,shadowOffsetX:0,shadowColor:"rgba(0, 0, 0, 0.5)"}}},{name:"销售单数",type:"pie",label:{normal:{show:!1}},labelLine:{normal:{show:!1}},radius:["0%","30%"],center:["40%","50%"],legendHoverLink:!0,data:this.echartsData.waycountData,itemStyle:{emphasis:{shadowBlur:10,shadowOffsetX:0,shadowColor:"rgba(0, 0, 0, 0.5)"}}}]}},setOption:function(){var t=this,e=document.getElementById("echarts-container"),a=[].concat(l()(this.resultData)),i=[],s=[],n=[],r={};this.totalSalsum=0,this.totalCount=0,a.sort(this.compare("salsum")),a.map(function(e,a){s.push({name:e.station_name,value:e.waycount}),i.push({name:e.station_name,value:e.salsum}),n.push(e.station_name),r[e.station_name]=a<10,t.totalSalsum+=e.salsum,t.totalCount+=e.waycount}),this.totalSalsum=this.totalSalsum.toFixed(3),this.echartsData={salsumData:i,waycountData:s,selectedData:r,legendData:n};var o=this.getOpt();this.myChart=this.$echarts.init(e),this.myChart.setOption(o)},dateToStr:function(t){var e=this.getDateDetail(t);return e.year+"-"+e.month+"-"+e.day+" "+e.hour+":"+e.minute+":"+e.second},getDateDetail:function(t){if(t&&t.getFullYear()){var e={};return e.year=t.getFullYear(),e.month=t.getMonth()+1>9?t.getMonth()+1:"0"+(t.getMonth()+1),e.day=t.getDate()>9?t.getDate():"0"+t.getDate(),e.hour=t.getHours()>9?t.getHours():"0"+t.getHours(),e.minute=t.getMinutes()>9?t.getMinutes():"0"+t.getMinutes(),e.second=t.getSeconds()>9?t.getSeconds():"0"+t.getSeconds(),e}return t},getdata:function(){var t=this,e=new Date(Date.parse(this.searchFilters.timeParam[0])),a=this.dateToStr(e),i=new Date(Date.parse(this.searchFilters.timeParam[1])),s=this.dateToStr(i);return this.pageLoading=!0,this.$$http("getMapData",{stime:a,etime:s,companyname:this.searchFilters.companyName}).then(function(e){t.pageLoading=!1,0==e.data.code&&(t.resultData=e.data.data)}).catch(function(){t.pageLoading=!1})},initMarkList:function(){var t=this;AMapUI.loadUI(["misc/MarkerList","overlay/SimpleMarker","overlay/SimpleInfoWindow","control/BasicControl"],function(e,a,i,s){t.map.addControl(new s.Zoom({position:"lt",showZoomNum:!0}));e.utils.$;t.markerList=new e({map:t.map,getPosition:function(t){return[t.longti,t.laiti]},getDataId:function(t,e){return e},getInfoWindow:function(t,e,a){var s='<div class="marker-info-window"><span class="fs-13">'+t.station_name+"</span>",n='<div class="fs-13 md-5">销售总额：'+t.salsum+'元</div><div class="fs-13 md-5">销售单数：'+t.waycount+"</div>";return a?(a.setInfoTitle(s),a.setInfoBody(n),a):new i({infoTitle:s,infoBody:n,offset:new AMap.Pixel(0,-37)})},getMarker:function(t,e,i){var s=a.getBuiltInIconStyles("default");return new a({containerClassNames:"my-marker",iconTheme:"default",iconStyle:s[17],iconLabel:{innerHTML:t.waycount,style:{color:"#fff"}},label:{content:t.station_name,offset:new AMap.Pixel(32,15)}})},markerEvents:["click","mouseover","mouseout"],selectedClassNames:"selected",autoSetFitView:!1})})},renderMarker:function(){var t=this,e=function(){t.markerList.render(t.resultData),t.map.plugin(["AMap.MarkerClusterer"],function(){t.allMakers=t.markerList.getAllMarkers(),t.cluster?t.cluster.setMarkers(t.allMakers):t.cluster=new AMap.MarkerClusterer(t.map,t.allMakers,{minClusterSize:4,maxZoom:17})})};this.markerList?e():setTimeout(function(){e()},1e3),this.map.setFitView(this.allMakers)},compare:function(t){return function(e,a){var i=e[t],s=a[t];return s<i?-1:s>i?1:0}},startSearch:function(){var t=this;this.getdata().then(function(e){t.renderMarker(),t.setOption()})},initCircle:function(){this.circleList.length&&this.map.remove([].concat(l()(this.circleList),l()(this.textMarkerList),l()(this.fluidMarkerList))),this.circleList=[],this.textMarkerList=[],this.fluidMarkerList=[];for(var t=0,e=this.choosedFuildList.length;t<e;t++)for(var a=1e5,i=1,s=0;s<7;s++){var n;s>2&&(i-=.2);var o=new AMap.Circle((n={center:[this.choosedFuildList[t].longtitude,this.choosedFuildList[t].latitude],radius:a,strokeColor:"#4A9BF8",strokeOpacity:1,strokeWeight:1.6},r()(n,"strokeOpacity",i),r()(n,"fillOpacity",0),r()(n,"strokeDasharray",[10,10]),r()(n,"fillColor","#4A9BF8"),r()(n,"zIndex",50),n)),c=new AMap.LngLat(this.choosedFuildList[t].longtitude,this.choosedFuildList[t].latitude),d=c.offset(Math.sqrt(a*a/2),Math.sqrt(a*a/2)),h=c.offset(0,a),f="";f=this.choosedFuildList[t].bill?this.choosedFuildList[t].bill[s].min+"~"+this.choosedFuildList[t].bill[s].max:"";var m=new AMap.Text({text:""+a/1e3,position:d,angle:"45",style:{"font-size":"12px","background-color":"#fff"}}),g=new AMap.Text({text:f,position:h,style:{"font-size":"12px","background-color":"#fff"}}),p=new AMap.Icon({size:new AMap.Size(20,20),image:u,imageSize:new AMap.Size(20,20)}),v=new AMap.Marker({position:[this.choosedFuildList[t].longtitude,this.choosedFuildList[t].latitude],icon:p,offset:new AMap.Pixel(-10,-10)}),M=new AMap.Text({text:this.choosedFuildList[t].fliud_name,position:[this.choosedFuildList[t].longtitude,this.choosedFuildList[t].latitude],style:{"font-size":"12px","background-color":"#fff"},offset:new AMap.Pixel(0,20)});a+=5e4,this.circleList.push(o),this.textMarkerList.push(m),this.textMarkerList.push(g),this.fluidMarkerList.push(v),this.textMarkerList.push(M)}this.map.add([].concat(l()(this.circleList),l()(this.textMarkerList),l()(this.fluidMarkerList)))},getFluid:function(){var t=this;return this.$$http("getFluid").then(function(e){t.getFuildLoading=!1,0==e.data.code&&(t.fluidList=e.data.data)}).catch(function(){t.getFuildLoading=!1})},getFluidBill:function(){var t=this;return this.$$http("getFluidBill",{fluid_name:this.searchFilters.fluid}).then(function(e){0==e.data.code&&(t.fluidBillData=e.data.data)})},fluidChange:function(){var t=this;this.getFluidBill().then(function(){t.choosedFuildList=[],t.searchFilters.fluid.map(function(e,a){t.fluidList.map(function(a,i){e===a.fliud_name&&(a.bill=t.fluidBillData[a.fliud_name]?s()(t.fluidBillData[a.fliud_name]):"",t.choosedFuildList.push(a))})}),console.log("this.choosedFuildList",t.choosedFuildList),t.initCircle()})}},created:function(){new Date}},"mounted",function(){var t=this;this.map=new AMap.Map("map-container",{zoom:5}),this.initMarkList(),this.getFluid(),this.getdata().then(function(e){t.renderMarker(),t.setOption(),t.initCircle()})}),d={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("el-form",{staticClass:"search-filters-form",attrs:{"label-width":"150px",model:t.searchFilters,"status-icon":""}},[a("el-row",{attrs:{type:"flex",justify:"left"}},[a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"业务结算完成时间:"}},[a("el-date-picker",{staticStyle:{width:"100%"},attrs:{editable:"editable",type:"datetimerange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期","value-format":"yyyy-MM-dd HH:mm:ss","default-time":["00:00:00","23:59:59"]},on:{change:t.startSearch},model:{value:t.searchFilters.timeParam,callback:function(e){t.$set(t.searchFilters,"timeParam",e)},expression:"searchFilters.timeParam"}})],1)],1)],1),t._v(" "),a("el-row",{attrs:{type:"flex",justify:"left"}},[a("el-col",{attrs:{span:6}},[a("el-form-item",{attrs:{label:"液厂:"}},[a("el-select",{staticStyle:{width:"100%"},attrs:{loading:t.getFuildLoading,filterable:"",multiple:"",clearable:"",placeholder:"请选择"},on:{change:t.fluidChange},model:{value:t.searchFilters.fluid,callback:function(e){t.$set(t.searchFilters,"fluid",e)},expression:"searchFilters.fluid"}},t._l(t.fluidList,function(t,e){return a("el-option",{key:e,attrs:{label:t.fliud_name,value:t.fliud_name}})}))],1)],1)],1)],1),t._v(" "),a("div",{directives:[{name:"loading",rawName:"v-loading",value:t.pageLoading,expression:"pageLoading"}],staticClass:"map-loading"}),t._v(" "),a("div",{staticClass:"map-title"},[t._v("业务单全国分布图")]),t._v(" "),a("div",{attrs:{id:"map-container"}}),t._v(" "),a("div",{attrs:{id:"echarts-container"}})],1)},staticRenderFns:[]};var h=a("VU/8")(c,d,!1,function(t){a("X1/u")},"data-v-812034f4",null);e.default=h.exports},TmV0:function(t,e,a){a("fZOM"),t.exports=a("FeBl").Object.values},"X1/u":function(t,e){},"c/Tr":function(t,e,a){t.exports={default:a("5zde"),__esModule:!0}},fBQ2:function(t,e,a){"use strict";var i=a("evD5"),s=a("X8DO");t.exports=function(t,e,a){e in t?i.f(t,e,s(0,a)):t[e]=a}},fZOM:function(t,e,a){var i=a("kM2E"),s=a("mbce")(!1);i(i.S,"Object",{values:function(t){return s(t)}})},gRE1:function(t,e,a){t.exports={default:a("TmV0"),__esModule:!0}},mEgX:function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAEVElEQVRYR5VXS3LbRhB9DQsG4E3oE0Q+gakThNqZ3Eg+QaSqgFVZxT6B6ROEWaWKTJWVE5jagN6ZOYGhE5g6QagNAYoSOtUDDDj4K7MjMd3zpvv1m27C/1jDv3bnlOCMiY+J0QOhr8wZIRM2AEICrQLfuX6qW+raOPjEvRf7+99BfA6g17U/+74B02JrP3+/uiQB1rhaAYzm0QSg30oHXwMcMlkhc6KcE1k94qQPkETkzDhtA9A08J2PTQhqAaS33n3NQwy+BWOytd1F141S2/gcBAH/o07R1nZO62wrAEaz+z4j+UyE4xQ1fwx8b1K+gexLLLyOn9nXTaCyCH5QXhhrgvU2GD8PTV8FAILe2+++yeHMuCNYg7KBNh7OoysC/dzkWO/LLrQiwg+yN7KdExNwAcBoFocgvO46XJwPZ/FGnB5IZ502gTVBSMUEY/dEA8wBmOECWydNztThUo7Mn0tp2WyPnFeN6Zjd90HJt3JaFQBFnIfd95Tt9Tk3D9PhrzK73da4ZA5WATg45NvA9zLyNdduKfzmRuXYe9hdEPMmGHtXFfLOo7VUBzP+WI7ddykAnU/myzoj08loFl2A6FMjPOZLqAqiD6jxZ9hvAt99SWY+t0fOy7ocipEGNpxFKyL6qUXclFApAKr+inzK0v2v+kT0lox8Xge+K3JbWPp78sCv5IN1RMKV1sWMBRFSXyXWy1+jebwQxZQ00OFGVQKZ4U7ApwRcSO13ASh/l5suf3HkULU0GZn5H8prv7SpWBkqXlcgvqg4B94D3G8DxuC/l76X2+ZpZ4Q0mscsTuWGX3xvlaPsIpvemOW4gxuKcNrkzTwaWKCv8rsFQKqKXeEOfFdV0ps/o+M2fpgELwLQ8lvJUxqZuqWkmrBi5t5y7A30nuEsnhJBnu/KMiNspOCmloSi3QfZrPGW1TqDNkvfnR7S1mxnAiiQ0ECdl6EZourxqVrKLXifhF9+9dbmHk3qsp2Usd5bLEPjYdF5agXQoZbauQlAUrYcu6qdqwiR/FmWYnNTk6MmfhRe1WyTWYZaWzSowmMkDcNy7CrFG2WPRgmAekDaKqMOQDH8NY9R1gmt0wYjVcRaRyWtqANStTso7IF8uIts51jencaGZGvb6xf73crUAvMmT0lBMfQtDcmhjHLx2YCtUwHh7eOFfv3KalkHIu8VDfnNylqUrwfGTTB204FGlNB0kpIvlqdU2mkFQlqzlDiYMGhq1n1tCpSw8UJ30oXDwbfbI7ff2JQq8ikRelzkPT1oIoOF4snj/cB81eoASAnrN6XIB5ktnp23tuXaYTaY5PmX6mDLmrTNAKat+7g/oySZ5LMF42ZrO4MnDSYFVZtHE2Z6Z7TfMmAIJ2S4CJmtbDRLRGT6zNzPG5F0GLkj4mndYFPLgbqQqtA/xFMwnZtA2rRADgZwFdnOpGuU65yOzYNE/5HwIGtAZDxPn2vGDYNlEA1h0aqLJ6bP/wAvAv60cBdoWgAAAABJRU5ErkJggg=="},mbce:function(t,e,a){var i=a("lktj"),s=a("TcQ7"),n=a("NpIQ").f;t.exports=function(t){return function(e){for(var a,r=s(e),o=i(r),l=o.length,u=0,c=[];l>u;)n.call(r,a=o[u++])&&c.push(t?[a,r[a]]:r[a]);return c}}},qyJz:function(t,e,a){"use strict";var i=a("+ZMJ"),s=a("kM2E"),n=a("sB3e"),r=a("msXi"),o=a("Mhyx"),l=a("QRG4"),u=a("fBQ2"),c=a("3fs2");s(s.S+s.F*!a("dY0y")(function(t){Array.from(t)}),"Array",{from:function(t){var e,a,s,d,h=n(t),f="function"==typeof this?this:Array,m=arguments.length,g=m>1?arguments[1]:void 0,p=void 0!==g,v=0,M=c(h);if(p&&(g=i(g,m>2?arguments[2]:void 0,2)),void 0==M||f==Array&&o(M))for(a=new f(e=l(h.length));e>v;v++)u(a,v,p?g(h[v],v):h[v]);else for(d=M.call(h),a=new f;!(s=d.next()).done;v++)u(a,v,p?r(d,g,[s.value,v],!0):s.value);return a.length=v,a}})}});
//# sourceMappingURL=2.13d3aa4cc74b357e57ff.js.map