webpackJsonp([0],{"5zde":function(t,e,a){a("zQR9"),a("qyJz"),t.exports=a("FeBl").Array.from},"9bBU":function(t,e,a){a("mClu");var n=a("FeBl").Object;t.exports=function(t,e,a){return n.defineProperty(t,e,a)}},C4MV:function(t,e,a){t.exports={default:a("9bBU"),__esModule:!0}},Gu7T:function(t,e,a){"use strict";e.__esModule=!0;var n,o=a("c/Tr"),r=(n=o)&&n.__esModule?n:{default:n};e.default=function(t){if(Array.isArray(t)){for(var e=0,a=Array(t.length);e<t.length;e++)a[e]=t[e];return a}return(0,r.default)(t)}},I8dn:function(t,e,a){t.exports=a("U08g")},LM1A:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=a("bOdI"),o=a.n(n),r=a("Gu7T"),i=a.n(r);a("I8dn");var s=o()({name:"HelloWorld",data:function(){return{resultData:[],searchFilters:{timeParam:[new Date((new Date).getFullYear(),(new Date).getMonth(),1),new Date]},map:"",markerList:"",allMakers:"",cluster:"",echartsData:{data:[],selectedData:[],legendData:[]},pageLoading:!1}},mounted:function(){},methods:{getOpt:function(){return{title:{text:"销售总额占比图",x:"center"},tooltip:{trigger:"item",formatter:"{a} <br/>{b} : {c} ({d}%)"},toolbox:{show:!0,right:"20%",feature:{dataView:{readOnly:!1},saveAsImage:{}}},legend:{type:"scroll",orient:"vertical",right:50,top:10,bottom:20,data:this.echartsData.legendData,selected:this.echartsData.selectedData},series:[{name:"销售总额",type:"pie",radius:["40%","65%"],center:["40%","50%"],data:this.echartsData.salsumData,legendHoverLink:!0,itemStyle:{emphasis:{shadowBlur:10,shadowOffsetX:0,shadowColor:"rgba(0, 0, 0, 0.5)"}}},{name:"销售单数",type:"pie",label:{normal:{show:!1}},labelLine:{normal:{show:!1}},radius:["0%","30%"],center:["40%","50%"],legendHoverLink:!0,data:this.echartsData.waycountData,itemStyle:{emphasis:{shadowBlur:10,shadowOffsetX:0,shadowColor:"rgba(0, 0, 0, 0.5)"}}}]}},setOption:function(){var t=document.getElementById("echarts-container"),e=[].concat(i()(this.resultData));e.sort(this.compare("salsum"));var a=e.map(function(t){return{name:t.station_name,value:t.salsum}}),n=e.map(function(t){return{name:t.station_name,value:t.waycount}}),o=e.map(function(t){return t.station_name}),r={};e.map(function(t,e){r[t.station_name]=e<10}),console.log("selectedData",r),this.echartsData={salsumData:a,waycountData:n,selectedData:r,legendData:o};var s=this.getOpt();this.myChart=this.$echarts.init(t),this.myChart.setOption(s)},dateToStr:function(t){var e=this.getDateDetail(t);return e.year+"-"+e.month+"-"+e.day+" "+e.hour+":"+e.minute+":"+e.second},getDateDetail:function(t){if(t&&t.getFullYear()){var e={};return e.year=t.getFullYear(),e.month=t.getMonth()+1>9?t.getMonth()+1:"0"+(t.getMonth()+1),e.day=t.getDate()>9?t.getDate():"0"+t.getDate(),e.hour=t.getHours()>9?t.getHours():"0"+t.getHours(),e.minute=t.getMinutes()>9?t.getMinutes():"0"+t.getMinutes(),e.second=t.getSeconds()>9?t.getSeconds():"0"+t.getSeconds(),e}return t},getdata:function(){var t=this,e=new Date(Date.parse(this.searchFilters.timeParam[0])),a=this.dateToStr(e),n=new Date(Date.parse(this.searchFilters.timeParam[1])),o=this.dateToStr(n);return this.pageLoading=!0,this.$$http("getMapData",{stime:a,etime:o}).then(function(e){t.pageLoading=!1,0==e.data.code&&(t.resultData=e.data.data,console.log("this.resultData",t.resultData))}).catch(function(){t.pageLoading=!1})},initMarkList:function(){var t=this;AMapUI.loadUI(["misc/MarkerList","overlay/SimpleMarker","overlay/SimpleInfoWindow","control/BasicControl"],function(e,a,n,o){t.map.addControl(new o.Zoom({position:"lt",showZoomNum:!0}));e.utils.$;t.markerList=new e({map:t.map,getPosition:function(t){return[t.longti,t.laiti]},getDataId:function(t,e){return e},getInfoWindow:function(t,e,a){var o='<div class="marker-info-window"><span class="fs-13">'+t.station_name+"</span>",r='<div class="fs-13 md-5">销售总额：'+t.salsum+'元</div><div class="fs-13 md-5">销售单数：'+t.waycount+"</div>";return a?(a.setInfoTitle(o),a.setInfoBody(r),a):new n({infoTitle:o,infoBody:r,offset:new AMap.Pixel(0,-37)})},getMarker:function(t,e,n){var o=a.getBuiltInIconStyles("default");return new a({containerClassNames:"my-marker",iconTheme:"default",iconStyle:o[17],iconLabel:{innerHTML:t.waycount,style:{color:"#fff"}},label:{content:t.station_name,offset:new AMap.Pixel(32,15)}})},markerEvents:["click","mouseover","mouseout"],selectedClassNames:"selected",autoSetFitView:!1})})},renderMarker:function(){var t=this,e=function(){t.markerList.render(t.resultData),t.map.plugin(["AMap.MarkerClusterer"],function(){t.allMakers=t.markerList.getAllMarkers(),t.cluster?t.cluster.setMarkers(t.allMakers):t.cluster=new AMap.MarkerClusterer(t.map,t.allMakers,{minClusterSize:4,maxZoom:17})})};this.markerList?e():setTimeout(function(){e()},1e3),this.map.setFitView(this.allMakers)},compare:function(t){return function(e,a){var n=e[t],o=a[t];return o<n?-1:o>n?1:0}},startSearch:function(){var t=this;this.getdata().then(function(e){t.renderMarker(),t.setOption()})}},created:function(){new Date}},"mounted",function(){var t=this;this.map=new AMap.Map("map-container",{zoom:5}),this.initMarkList(),this.getdata().then(function(e){t.renderMarker(),t.setOption()})}),l={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("el-form",{staticClass:"search-filters-form",attrs:{"label-width":"150px",model:t.searchFilters,"status-icon":""}},[a("el-row",{attrs:{type:"flex",justify:"left"}},[a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"业务结算完成时间:"}},[a("el-date-picker",{staticStyle:{width:"100%"},attrs:{editable:"editable",type:"datetimerange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期","value-format":"yyyy-MM-dd HH:mm:ss","default-time":["00:00:00","23:59:59"]},on:{change:t.startSearch},model:{value:t.searchFilters.timeParam,callback:function(e){t.$set(t.searchFilters,"timeParam",e)},expression:"searchFilters.timeParam"}})],1)],1)],1)],1),t._v(" "),a("div",{directives:[{name:"loading",rawName:"v-loading",value:t.pageLoading,expression:"pageLoading"}],staticClass:"map-loading"}),t._v(" "),a("div",{staticClass:"map-title"},[t._v("业务单全国分布图")]),t._v(" "),a("div",{attrs:{id:"map-container"}}),t._v(" "),a("div",{attrs:{id:"echarts-container"}})],1)},staticRenderFns:[]};var c=a("VU/8")(s,l,!1,function(t){a("vAUB")},"data-v-730c38e2",null);e.default=c.exports},U08g:function(t,e,a){var n;n=function(t){return function(t){function e(n){if(a[n])return a[n].exports;var o=a[n]={i:n,l:!1,exports:{}};return t[n].call(o.exports,o,o.exports,e),o.l=!0,o.exports}var a={};return e.m=t,e.c=a,e.i=function(t){return t},e.d=function(t,a,n){e.o(t,a)||Object.defineProperty(t,a,{configurable:!1,enumerable:!0,get:n})},e.n=function(t){var a=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(a,"a",a),a},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="",e(e.s=4)}([function(e,a){e.exports=t},function(t,e,a){function n(t,e){this._amap=t,this.dimensions=["lng","lat"],this._mapOffset=[0,0],this._api=e}var o=a(0);n.prototype.dimensions=["lng","lat"],n.prototype.setZoom=function(t){this._zoom=t},n.prototype.setCenter=function(t){this._center=this._amap.lnglatToPixel(t)},n.prototype.setMapOffset=function(t){this._mapOffset=t},n.prototype.getAMap=function(){return this._amap},n.prototype.dataToPoint=function(t){var e=new AMap.LngLat(t[0],t[1]),a=this._amap.lngLatToContainer(e),n=this._mapOffset;return[a.x-n[0],a.y-n[1]]},n.prototype.pointToData=function(t){var e=this._mapOffset;return[(t=this._amap.containerToLngLat({x:t[0]+e[0],y:t[1]+e[1]})).lng,t.lat]},n.prototype.getViewRect=function(){var t=this._api;return new o.graphic.BoundingRect(0,0,t.getWidth(),t.getHeight())},n.prototype.getRoamTransform=function(){return o.matrix.create()},n.dimensions=n.prototype.dimensions,n.create=function(t,e){var a,r=e.getDom();t.eachComponent("amap",function(t){var i=e.getZr().painter.getViewportRoot();if("undefined"==typeof AMap)throw new Error("AMap api is not loaded");if(a)throw new Error("Only one amap component can exist");if(!t.__amap){var s=r.querySelector(".ec-extension-amap");s&&(i.style.left="0px",i.style.top="0px",r.removeChild(s)),(s=document.createElement("div")).style.cssText="width:100%;height:100%",s.classList.add("ec-extension-amap"),r.appendChild(s);var l=t.get()||{};l=t.__options=o.util.clone(l);var c=t.__amap=new AMap.Map(s,l);(u=t.__layer=new AMap.CustomLayer(i)).setMap(c)}var u;c=t.getAMap();(u=t.getLayer()).hide();var d=c.getZoom(),p=c.getCenter();(a=new n(c,e)).setMapOffset(t.__mapOffset||[0,0]),a.setZoom(d),a.setCenter([p.lng,p.lat]),t.coordinateSystem=a,u.show()}),t.eachSeries(function(t){"amap"===t.get("coordinateSystem")&&(t.coordinateSystem=a)})},t.exports=n},function(t,e,a){t.exports=a(0).extendComponentModel({type:"amap",getAMap:function(){return this.__amap},getLayer:function(){return this.__layer},getMapOptions:function(){return this.__options},setCenterAndZoom:function(t,e){this.option.center=t,this.option.zoom=e},centerOrZoomChanged:function(t,e){var a=this.option;return!(function(t,e){return t&&e&&t[0]===e[0]&&t[1]===e[1]}(t,a.center)&&e===a.zoom)},defaultOption:{center:[116.397475,39.908695],zoom:4}})},function(t,e,a){var n=a(0);t.exports=a(0).extendComponentView({type:"amap",render:function(t,e,a){function o(){r||a.dispatchAction({type:"amapRoam"})}var r=!0,i=t.getAMap(),s=a.getZr().painter.getViewportRoot(),l=t.coordinateSystem,c=function(e){if(!r){var n=s.parentNode.parentNode.parentNode,o=[-parseInt(n.style.left,10)||0,-parseInt(n.style.top,10)||0];s.style.left=o[0]+"px",s.style.top=o[1]+"px",l.setMapOffset(o),t.__mapOffset=o,a.dispatchAction({type:"amapRoam"})}},u=function(t,e,a){var n,o,r,i;return i=function(){n=!1,o&&(r.apply(a,o),o=!1)},r=function(){n?o=arguments:(t.apply(a,arguments),setTimeout(i,e),n=!0)}}(function(t){n.getInstanceByDom(a.getDom()).resize(),c.call(this,t)},300,i);i.off("movestart",this._oldMoveHandler),i.off("zoomend",this._oldZoomEndHandler),i.off("moveend",this._oldZoomEndHandler),i.off("complete",this._oldZoomEndHandler),t.get("resizeEnable")&&i.off("resize",this._oldResizeHandler),i.on("movestart",c),i.on("zoomend",o),i.on("moveend",o),i.on("complete",o),t.get("resizeEnable")&&i.on("resize",u),this._oldMoveHandler=c,this._oldZoomEndHandler=o,this._oldResizeHandler=u,r=!1}})},function(t,e,a){a(0).registerCoordinateSystem("amap",a(1)),a(2),a(3),a(0).registerAction({type:"amapRoam",event:"amapRoam",update:"updateLayout"},function(t,e){e.eachComponent("amap",function(t){var e=t.getAMap(),a=e.getCenter();t.setCenterAndZoom([a.lng,a.lat],e.getZoom())})}),t.exports={version:"1.0.0-rc.6"}}])},t.exports=n(a("XLwt"))},bOdI:function(t,e,a){"use strict";e.__esModule=!0;var n,o=a("C4MV"),r=(n=o)&&n.__esModule?n:{default:n};e.default=function(t,e,a){return e in t?(0,r.default)(t,e,{value:a,enumerable:!0,configurable:!0,writable:!0}):t[e]=a,t}},"c/Tr":function(t,e,a){t.exports={default:a("5zde"),__esModule:!0}},fBQ2:function(t,e,a){"use strict";var n=a("evD5"),o=a("X8DO");t.exports=function(t,e,a){e in t?n.f(t,e,o(0,a)):t[e]=a}},mClu:function(t,e,a){var n=a("kM2E");n(n.S+n.F*!a("+E39"),"Object",{defineProperty:a("evD5").f})},qyJz:function(t,e,a){"use strict";var n=a("+ZMJ"),o=a("kM2E"),r=a("sB3e"),i=a("msXi"),s=a("Mhyx"),l=a("QRG4"),c=a("fBQ2"),u=a("3fs2");o(o.S+o.F*!a("dY0y")(function(t){Array.from(t)}),"Array",{from:function(t){var e,a,o,d,p=r(t),f="function"==typeof this?this:Array,m=arguments.length,h=m>1?arguments[1]:void 0,g=void 0!==h,v=0,y=u(p);if(g&&(h=n(h,m>2?arguments[2]:void 0,2)),void 0==y||f==Array&&s(y))for(a=new f(e=l(p.length));e>v;v++)c(a,v,g?h(p[v],v):p[v]);else for(d=y.call(p),a=new f;!(o=d.next()).done;v++)c(a,v,g?i(d,h,[o.value,v],!0):o.value);return a.length=v,a}})},vAUB:function(t,e){}});
//# sourceMappingURL=0.7449185fd06046bb4439.js.map